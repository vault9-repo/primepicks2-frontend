<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PrimePicks Soccer Tips</title>

  <!-- ✅ Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- ✅ Bootstrap Icons -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    rel="stylesheet"
  />

  <!-- ✅ Custom Styles -->
  <style>
    body {
      background: url('BACKGROUND.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7));
      z-index: -1;
    }

    /* Floating Glassy Social Buttons */
    .social-buttons {
      position: fixed;
      top: 20px;
      left: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1000;
    }
    .social-buttons a {
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      color: #fff;
      font-size: 1.4rem;
      text-decoration: none;
      backdrop-filter: blur(6px);
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.15);
      transition: all 0.3s ease;
      box-shadow: 0 0 12px rgba(255, 255, 255, 0.15);
    }
    .social-buttons a:hover {
      transform: scale(1.1);
      background: rgba(255, 255, 255, 0.15);
    }
    .facebook  { color: #1877f2; text-shadow: 0 0 8px rgba(24,119,242,0.7); }
    .whatsapp  { color: #25d366; text-shadow: 0 0 8px rgba(37,211,102,0.7); }
    .telegram  { color: #708090; text-shadow: 0 0 8px rgba(112,128,144,0.7); }
    .gmail     { color: #ff4c68; text-shadow: 0 0 8px rgba(255,76,104,0.7); }
    .apk       { color: #28a745; text-shadow: 0 0 8px rgba(40,167,69,0.7); }
    .website   { color: #17a2b8; text-shadow: 0 0 8px rgba(23,162,184,0.7); }
    .social-buttons a span {
      display: none;
    }
    .social-buttons a:hover span {
      display: inline-block;
      position: absolute;
      left: 60px;
      background: rgba(0,0,0,0.75);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.8rem;
      white-space: nowrap;
    }

    /* Hero + Dashboard */
    .hero { text-align: center; padding: 50px 20px 20px; }
    .hero h1 { font-size: 3rem; font-weight: bold; }
    .hero p { font-size: 1.2rem; margin: 10px 0; }

    .btn-success {
      font-size: 1.3rem;
      padding: 15px 40px;
      margin-top: 10px;
      transition: all 0.3s;
    }
    .btn-success:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px #28a745;
    }

    .center-logo img {
      max-width: 150px;
      width: 100%;
      height: auto;
      border-radius: 50%;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
      margin: 2rem auto;
      display: block;
    }

    .dashboard {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 2rem;
    }

    .upcoming-matches {
      flex: 1;
      min-width: 300px;
      max-height: 600px;
      overflow-y: auto;
      position: relative;

      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .upcoming-matches::-webkit-scrollbar {
      width: 0px;
      background: transparent;
    }

    .match-card {
      background: rgba(0, 0, 0, 0.75);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: transform 0.2s;
    }
    .match-card:hover { transform: scale(1.02); }
    .team-logo { height: 40px; width: 40px; object-fit: contain; }
    .match-info { flex: 1; margin: 0 10px; text-align: center; }
    .countdown { font-weight: bold; color: #0d6efd; }

    .countdown.urgent { color: #ff4c68; font-weight: bold; }

    .predictions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 2rem;
    }

    .prediction-card {
      background: rgba(0,0,0,0.75);
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      position: relative;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 0 25px 5px rgba(0, 255, 0, 0.5);
    }

    .won-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background-color: #0d6efd;
      color: #fff;
      font-size: 0.75rem;
      font-weight: bold;
      padding: 3px 7px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }

    footer {
      text-align: center;
      padding: 20px;
      background: rgba(0,0,0,0.8);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes signalPulse {
      0% { box-shadow: 0 0 10px rgba(40,167,69,0.4), 0 0 20px rgba(40,167,69,0.5); }
      50% { box-shadow: 0 0 35px rgba(40,167,69,0.9), 0 0 50px rgba(40,167,69,1); }
      100% { box-shadow: 0 0 10px rgba(40,167,69,0.4), 0 0 20px rgba(40,167,69,0.5); }
    }
  </style>
</head>
<body>

<!-- Floating Social Buttons -->
<div class="social-buttons">
  <a href="https://www.facebook.com/profile.php?id=61581288185889" target="_blank" class="facebook">
    <i class="bi bi-facebook"></i><span>Facebook</span>
  </a>
  <a href="https://api.whatsapp.com/send?phone=25424735630756" target="_blank" class="whatsapp">
    <i class="bi bi-whatsapp"></i><span>WhatsApp</span>
  </a>
  <a href="https://t.me/primepicks254" target="_blank" class="telegram">
    <i class="bi bi-telegram"></i><span>Telegram</span>
  </a>
  <a href="mailto:fxvault9@gmail.com" target="_blank" class="gmail">
    <i class="bi bi-envelope-fill"></i><span>Gmail</span>
  </a>
  <a href="https://median.co/share/rdejjdb#apk" target="_blank" class="apk">
    <i class="bi bi-download"></i><span>APK</span>
  </a>
  <a href="https://primepicks-n97g.onrender.com/" target="_blank" class="website">
    <i class="bi bi-globe"></i><span>Website</span>
  </a>
</div>

<section class="hero">
  <h1>PrimePicks Soccer Tips</h1>
  <p>Accurate Live Soccer Predictions, Daily Matches, and Scores</p>
  <div class="center-logo">
    <img src="https://cdnb.artstation.com/p/assets/images/images/019/945/785/large/stefan-radenkovic-uefa-ball-black-blue.jpg?1565705671" alt="UCL Ball"/>
  </div>
</section>

<section class="hero-cta text-center mb-4">
  <p style="font-size:1.2rem; font-weight:bold; color:#ffd700;">
    Download our app to access <span style="color:#0d6efd;">Experts Free & Premium Surebets</span> instantly!
  </p>
  <a href="https://median.co/share/rdejjdb#apk" target="_blank" class="btn btn-success">
    Download & Install App
  </a>
  <p style="font-size:0.9rem; margin-top:5px;">Install on your device to unlock all predictions and live tips.</p>
</section>

<div class="container">
  <div class="dashboard">
    <div class="upcoming-matches">
      <h4>Today's Expert Predictions</h4>
      <div id="upcomingContainer" class="text-center py-4">
        <div id="upcomingSpinner" class="spinner-border text-light" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>
  </div>

  <h4>Top Predictions</h4>
  <div class="predictions-grid" id="predictionsContainer"></div>
</div>

<footer>
  <p>Follow us on Telegram / WhatsApp / Instagram | Gamble Responsibly</p>
  <p>&copy; 2025 PrimePicks Soccer Tips</p>
</footer>

<script type="module">
const API_BASE = "https://primepickstip.onrender.com";
let userId = localStorage.getItem("pp_userId");
if (!userId) { userId = crypto.randomUUID(); localStorage.setItem("pp_userId", userId); }

async function trackClick(type){
  try {
    await fetch(`${API_BASE}/api/clicks`, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({userId, type})
    });
  } catch(e) { console.error(e); }
}

window.addEventListener("load", ()=>trackClick("homepage"));
document.querySelector(".btn-success")?.addEventListener("click", ()=>trackClick("download"));

const upcomingContainer = document.getElementById('upcomingContainer');
const predictionsContainer = document.getElementById('predictionsContainer');
const spinner = document.getElementById('upcomingSpinner');
const teamLogos = {};
const countdownElements = [];

function getTeamLogo(teamName){
  return `logos/${teamName}.png`; // relative path for local images
}

function getCountdown(date){
  const matchTime = new Date(date);
  const now = new Date();
  const matchDurationMs = 90*60*1000;
  if(now < matchTime){
    const diff=matchTime-now;
    const h=Math.floor(diff/(1000*60*60));
    const m=Math.floor((diff % (1000*60*60))/(1000*60));
    const s=Math.floor((diff % (1000*60))/1000);
    return {text:`${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`, minutesLeft:h*60+m, status:'upcoming'};
  } else if(now >= matchTime && now <= matchTime.getTime()+matchDurationMs){
    return {text:'LIVE', minutesLeft:0, status:'live'};
  } else { return {text:'ENDED', minutesLeft:0, status:'ended'}; }
}

async function fetchMatches(){
  spinner.style.display="inline-block"; upcomingContainer.style.opacity="0.5"; countdownElements.length=0;
  try {
    const res = await fetch(`${API_BASE}/admin/fixtures`);
    const data = await res.json();
    upcomingContainer.innerHTML="";
    data.sort((a,b)=> new Date(a.date+"T"+a.time)-new Date(b.date+"T"+b.time));
    data.forEach(f=>{
      const div=document.createElement('div');
      div.classList.add('match-card');
      const cd=getCountdown(f.date+"T"+f.time);
      div.innerHTML=`
        <img src="${getTeamLogo(f.homeTeam)}" class="team-logo"/>
        <div class="match-info">
          <h6>${f.homeTeam} vs ${f.awayTeam}</h6>
          <p>${f.leagueId||''}</p>
          <p>Countdown: <span class="countdown ${cd.minutesLeft<10?'urgent':''}" data-time="${f.date}T${f.time}">${cd.text}</span></p>
        </div>
        <img src="${getTeamLogo(f.awayTeam)}" class="team-logo"/>
      `;
      upcomingContainer.appendChild(div);
      countdownElements.push(div.querySelector(".countdown"));
    });
  } catch(e){ upcomingContainer.innerHTML="<p class='text-danger'>Failed to load matches</p>"; console.error(e);}
  finally{spinner.style.display="none"; upcomingContainer.style.opacity="1";}
}

setInterval(()=>{
  countdownElements.forEach(el=>{
    const date=el.getAttribute("data-time");
    const cd=getCountdown(date);
    el.textContent=cd.text;
    el.classList.remove("urgent"); el.style.color="#0d6efd"; el.style.fontWeight="normal"; el.style.animation="";
    if(cd.status==='upcoming' && cd.minutesLeft<10) el.classList.add("urgent");
    if(cd.status==='live'){ el.style.color='#28a745'; el.style.fontWeight='bold'; el.style.animation='pulseText 1s infinite'; }
    if(cd.status==='ended'){ el.style.color='#ff4c68'; el.style.fontWeight='bold'; }
  });
},1000);

async function fetchPredictions(){
  const res = await fetch(`${API_BASE}/admin/predictions`);
  const data = await res.json(); 
  predictionsContainer.innerHTML = "";

  data.forEach((f, index) => { // <-- get index to separate top images
    const div = document.createElement('div'); 
    div.classList.add('prediction-card');

    // Use top images in order: top1.PNG, top2.PNG, top3.PNG...
    const topImage = `logos/top${index+1}.PNG`;

    div.innerHTML = `
      <span class="won-badge">WON</span>
      <img src="${getTeamLogo(f.homeTeam)}" class="team-logo"><br/>
      <strong>${f.homeTeam}</strong><br/>vs<br/>
      <strong>${f.awayTeam}</strong><br/>
      <img src="${getTeamLogo(f.awayTeam)}" class="team-logo">
      <button class="view-stats-btn">STATS</button>
    `;

    const btn = div.querySelector(".view-stats-btn");
    btn.style.cssText = `
      position:absolute; bottom:8px; right:8px;
      background: rgba(0,0,0,0.6);
      color: #28a745;
      border: 1px solid rgba(40,167,69,0.6);
      padding: 4px 8px;
      border-radius:6px;
      font-size:11px;
      cursor:pointer;
      backdrop-filter: blur(6px);
      box-shadow: 0 0 12px rgba(40,167,69,0.7);
      animation:signalPulse 2s infinite;
      transition: all 0.3s ease;
    `;
    btn.onmouseover = () => {
      btn.style.background='rgba(0,0,0,0.8)';
      btn.style.boxShadow='0 0 20px rgba(40,167,69,1)';
    };
    btn.onmouseout = () => {
      btn.style.background='rgba(0,0,0,0.6)';
      btn.style.boxShadow='0 0 12px rgba(40,167,69,0.7)';
    };
    btn.addEventListener("click", e => {
      e.stopPropagation(); 
      popup.style.display = "flex"; 
      popupImg.style.display = "block"; 
      pageSpinner.style.display = "none";

      popupImg.src = topImage; // <-- set specific top image
    });

    predictionsContainer.appendChild(div);
  });
}


// Popup
const popup=document.createElement("div");
popup.id="imagePopup";
popup.style.cssText=`display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:9999;justify-content:center;align-items:center;flex-direction:column;`;
popup.innerHTML=`
  <div id="pageSpinner" style="border:6px solid rgba(255,255,255,0.3);border-top:6px solid #0d6efd;border-radius:50%;width:60px;height:60px;animation:spin 1s linear infinite;margin-bottom:20px;"></div>
  <img id="popupImage" src="" alt="Top Image" style="max-width:90%;max-height:85%;border-radius:12px;display:none;">
`;
document.body.appendChild(popup);
const popupImg=document.getElementById('popupImage');
const pageSpinner=document.getElementById('pageSpinner');
popup.addEventListener("click", e=>{ if(e.target===popup) popup.style.display="none"; popupImg.src=""; });
window.addEventListener("popstate", ()=>{popup.style.display="none"; popupImg.src="";});

fetchMatches();
fetchPredictions();
setInterval(fetchMatches,60000);
setInterval(fetchPredictions,60000);

const style = document.createElement('style');
style.innerHTML = `@keyframes pulseText {0% {text-shadow:0 0 5px #28a745;}50% {text-shadow:0 0 20px #28a745;}100% {text-shadow:0 0 5px #28a745;}}`;
document.head.appendChild(style);
</script>
</body>
</html>
